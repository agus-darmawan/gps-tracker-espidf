â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘               MODULAR CODE STRUCTURE                             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¦ PROJECT MODULES (After Refactoring)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1ï¸âƒ£  MAIN APPLICATION MODULE
    â”œâ”€â”€ main.c (180 lines)
    â””â”€â”€ Purpose: Clean application entry point
        â”œâ”€â”€ System initialization
        â”œâ”€â”€ Step-by-step startup
        â”œâ”€â”€ Module orchestration
        â””â”€â”€ Main event loop

2ï¸âƒ£  FREERTOS TASKS MODULE  â­ NEW
    â”œâ”€â”€ vehicle_tasks.h
    â”œâ”€â”€ vehicle_tasks.c (350 lines)
    â””â”€â”€ Purpose: All FreeRTOS task implementations
        â”œâ”€â”€ GPS reading task
        â”œâ”€â”€ Vehicle tracking task
        â”œâ”€â”€ System monitor task
        â””â”€â”€ Task management functions

3ï¸âƒ£  WEB CONFIGURATION MODULE (Split into 3)
    
    A) NVS STORAGE  â­ REFACTORED
       â”œâ”€â”€ web_config.h
       â”œâ”€â”€ web_config.c (100 lines)
       â””â”€â”€ Purpose: Non-Volatile Storage only
           â”œâ”€â”€ Save vehicle ID
           â”œâ”€â”€ Load configuration
           â””â”€â”€ Check configuration status
    
    B) HTML CONTENT  â­ NEW
       â”œâ”€â”€ web_html.h
       â”œâ”€â”€ web_html.c (150 lines)
       â””â”€â”€ Purpose: Web page content only
           â”œâ”€â”€ Configuration form
           â”œâ”€â”€ Styling (CSS)
           â””â”€â”€ Client-side logic (JavaScript)
    
    C) HTTP SERVER  â­ NEW
       â”œâ”€â”€ web_server.h
       â”œâ”€â”€ web_server.c (180 lines)
       â””â”€â”€ Purpose: HTTP request handling only
           â”œâ”€â”€ GET / (serve HTML)
           â”œâ”€â”€ POST /save (save config)
           â”œâ”€â”€ GET /status (JSON status)
           â””â”€â”€ Server lifecycle management

4ï¸âƒ£  WIFI MODULE
    â”œâ”€â”€ wifi.h
    â”œâ”€â”€ wifi_manager.c (85 lines)
    â””â”€â”€ Purpose: WiFi connection management
        â”œâ”€â”€ Connect to AP
        â”œâ”€â”€ Auto-reconnect
        â””â”€â”€ Connection status

5ï¸âƒ£  MQTT MODULE
    â”œâ”€â”€ mqtt_vehicle_client.h
    â”œâ”€â”€ mqtt_vehicle_client.c (390 lines)
    â””â”€â”€ Purpose: MQTT communication
        â”œâ”€â”€ Publish location/status/battery
        â”œâ”€â”€ Subscribe to commands
        â”œâ”€â”€ Handle start/end/kill commands
        â””â”€â”€ Performance report publishing

6ï¸âƒ£  GPS MODULE
    â”œâ”€â”€ gps.h
    â”œâ”€â”€ gps.c (270 lines)
    â””â”€â”€ Purpose: GPS data acquisition
        â”œâ”€â”€ UART communication
        â”œâ”€â”€ NMEA parsing (GPGGA, GPRMC)
        â””â”€â”€ Coordinate conversion

7ï¸âƒ£  TEMPERATURE SENSOR MODULE
    â”œâ”€â”€ max6675.h
    â”œâ”€â”€ max6675.c (75 lines)
    â””â”€â”€ Purpose: Engine temperature monitoring
        â”œâ”€â”€ SPI communication
        â””â”€â”€ Temperature reading

8ï¸âƒ£  IMU MODULE
    â”œâ”€â”€ mpu6050.h
    â”œâ”€â”€ mpu6050.c (140 lines)
    â””â”€â”€ Purpose: Orientation tracking
        â”œâ”€â”€ I2C communication
        â”œâ”€â”€ Accelerometer/Gyroscope data
        â””â”€â”€ Pitch/Roll calculation

9ï¸âƒ£  PERFORMANCE MODULE
    â”œâ”€â”€ vehicle_performance.h
    â”œâ”€â”€ vehicle_performance.c (260 lines)
    â””â”€â”€ Purpose: Component wear calculation
        â”œâ”€â”€ Physics-based formulas
        â”œâ”€â”€ Component tracking
        â”œâ”€â”€ Weight classification
        â””â”€â”€ Trip statistics


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“Š MODULE DEPENDENCIES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

main.c
  â”œâ”€â†’ wifi_manager.c
  â”œâ”€â†’ web_config.c
  â”œâ”€â†’ web_server.c
  â”œâ”€â†’ gps.c
  â”œâ”€â†’ max6675.c
  â”œâ”€â†’ mpu6050.c
  â”œâ”€â†’ vehicle_performance.c
  â”œâ”€â†’ mqtt_vehicle_client.c
  â””â”€â†’ vehicle_tasks.c

vehicle_tasks.c
  â”œâ”€â†’ gps.c
  â”œâ”€â†’ max6675.c
  â”œâ”€â†’ mpu6050.c
  â”œâ”€â†’ vehicle_performance.c
  â”œâ”€â†’ mqtt_vehicle_client.c
  â””â”€â†’ web_config.c

web_server.c
  â”œâ”€â†’ web_html.c
  â””â”€â†’ web_config.c

mqtt_vehicle_client.c
  â””â”€â†’ vehicle_performance.c


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ¯ KEY BENEFITS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… SEPARATION OF CONCERNS
   â€¢ Each module has ONE clear responsibility
   â€¢ Easy to understand what each file does

âœ… MAINTAINABILITY
   â€¢ Update HTML without touching C code
   â€¢ Modify server logic without touching storage
   â€¢ Change tasks without touching main

âœ… TESTABILITY
   â€¢ Test storage independently
   â€¢ Test server endpoints separately
   â€¢ Mock modules for unit testing

âœ… READABILITY
   â€¢ main.c is now clean and clear (180 lines vs 415)
   â€¢ No more scrolling through 600+ lines
   â€¢ Self-documenting structure

âœ… EXTENSIBILITY
   â€¢ Add new tasks easily in vehicle_tasks.c
   â€¢ Add new HTTP endpoints in web_server.c
   â€¢ Replace storage backend in web_config.c

âœ… TEAM COLLABORATION
   â€¢ Frontend dev works on web_html.c
   â€¢ Backend dev works on web_server.c
   â€¢ Embedded dev works on vehicle_tasks.c
   â€¢ No conflicts!


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ FILE SIZE COMPARISON
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

BEFORE REFACTORING:
main.c              415 lines  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
web_config.c        280 lines  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
(8 files total)

AFTER REFACTORING:
main.c              180 lines  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
vehicle_tasks.c     350 lines  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
web_config.c        100 lines  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
web_html.c          150 lines  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
web_server.c        180 lines  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
(11 files total)

Result: Better organized, more maintainable!


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”„ MIGRATION PATH
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Old Code                    â†’  New Code
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
web_config_start()          â†’  web_server_start()
web_config_stop()           â†’  web_server_stop()
(inline GPS task)           â†’  vehicle_tasks_start()
(inline tracking loop)      â†’  vehicle_tracking_task()
(embedded HTML)             â†’  web_html.c (separate file)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ¨ NEW FEATURES ADDED
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. System Monitor Task
   â€¢ Periodic health logging
   â€¢ Memory usage tracking
   â€¢ Connection status monitoring

2. Beautiful Startup Sequence
   â€¢ ASCII art banner
   â€¢ Step-by-step progress
   â€¢ Clear status messages

3. Improved Web UI
   â€¢ Modern gradient design
   â€¢ Smooth animations
   â€¢ Better form validation
   â€¢ Real-time feedback

4. Better Error Handling
   â€¢ Graceful sensor failures
   â€¢ Clear error messages
   â€¢ Recovery mechanisms


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“š DOCUMENTATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

README.md              - Project overview & API
INSTALLATION.md        - Setup instructions
TESTING.md             - Test procedures
FLOW_DIAGRAM.md        - System architecture
PROJECT_SUMMARY.md     - Complete summary
REFACTOR_NOTES.md      - Refactoring details  â­ NEW
MODULE_STRUCTURE.txt   - This file  â­ NEW


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ LEARNING RESOURCES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Want to understand the code better?

1. Start with:     main.c
2. Then read:      vehicle_tasks.c
3. Understand:     Module headers (*.h files)
4. Deep dive:      Individual modules (*.c files)

Each module is self-contained and well-documented!


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… STATUS: PRODUCTION READY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Version: 2.0.0 (Modular Architecture)
Date: November 12, 2025
Quality: Enterprise Grade
Testing: Comprehensive
Documentation: Complete